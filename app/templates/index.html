{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ramitham | Kerala Art Fest Leaderboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
:root{
    --red:#FF0000;
    --soft:#fff3f3;
}

/* ================= BASE ================= */
body{
    font-family:'Patrick Hand', cursive;
    background: linear-gradient(180deg, #ffeaea, #ffffff);
    overflow-x:hidden;
}

/* ================= HERO ================= */
.hero{
    text-align:center;
    padding:48px 15px 30px;
}

/* ================= LOGO ================= */
.hero-logo{
    display:flex;
    justify-content:center;
    margin-bottom:4px;
}

.hero-logo img{
    max-width:420px;
    width:100%;
    height:auto;
    filter:
        drop-shadow(0 10px 18px rgba(255,0,0,.25))
        drop-shadow(0 0 26px rgba(255,150,150,.35));
}

/* Responsive logo */
@media(max-width:768px){
    .hero-logo img{ max-width:300px; }
}
@media(max-width:420px){
    .hero-logo img{ max-width:240px; }
}

/* ================= SUBTEXT ================= */
.hero-subtext{
    margin-top:4px;
    font-size:1rem;
    color:#444;
    text-align:center;
}

@media(max-width:420px){
    .hero-subtext{
        font-size:.9rem;
    }
}

/* ================= BOARD ================= */
.board{
    background:white;
    border-radius:28px;
    padding:26px;
    border:4px dashed var(--red);
    box-shadow:0 24px 55px rgba(0,0,0,.2);
    position:relative;
}

/* Sticker labels */
.sticker{
    position:absolute;
    background:var(--red);
    color:white;
    padding:6px 14px;
    border-radius:18px;
    font-size:.95rem;
}
.st1{top:-14px;left:20px;transform:rotate(-8deg)}
.st2{top:-14px;right:20px;transform:rotate(6deg)}

/* ================= TABLE ================= */
.leaderboard-table{
    table-layout:fixed;
    width:100%;
}

.col-rank{width:90px}
.col-team{width:40%}
.col-dept{width:30%}
.col-points{width:120px}

thead th{
    text-align:center;
    font-size:1.25rem;
    color:var(--red);
    border-bottom:3px solid var(--red);
}

tbody td{
    text-align:center;
    padding:18px 10px;
    font-size:1.2rem;
}

/* ================= RANK ================= */
.rank-badge{
    display:inline-block;
    width:40px;
    font-size:1.6rem;
}

/* Bounce top 3 only */
tbody tr:nth-child(1) .rank-badge,
tbody tr:nth-child(2) .rank-badge,
tbody tr:nth-child(3) .rank-badge{
    animation:bounce 2s infinite;
}
@keyframes bounce{
    0%,100%{transform:translateY(0)}
    50%{transform:translateY(-6px)}
}

/* ================= TEAM ================= */
.team-link{
    text-decoration:none;
    color:black;
}
.team-link:hover{
    color:var(--red);
    text-decoration:underline;
}

/* ================= POINTS ================= */
.points{
    font-size:1.6rem;
    font-weight:800;
    color:var(--red);
}

/* ================= ROW EFFECT ================= */
tbody tr{
    transition:.25s;
    position:relative;
}
tbody tr:hover{
    background:var(--soft);
}
tbody tr:hover::after{
    content:"üé®";
    position:absolute;
    right:12px;
    font-size:1.5rem;
}

/* ================= UPDATE ANIMATION ================= */
.row-updated{
    animation:pop .6s ease;
}
@keyframes pop{
    0%{transform:scale(1)}
    40%{transform:scale(1.15)}
    100%{transform:scale(1)}
}

/* ================= FOOTER ================= */
footer{
    text-align:center;
    padding:22px;
    font-size:1.05rem;
}
</style>
</head>

<body>

<!-- ================= HERO ================= -->
<section class="hero">

    <div class="hero-logo">
        <img src="{% static 'images/ramitham_logo-removebg-preview.png' %}"
             alt="Ramitham 2025‚Äì26 Logo">
    </div>

    <div class="hero-subtext">
        Department Students‚Äô Union ¬∑ Dr Janaki Ammal Campus <strong>2025‚Äì26</strong>
    </div>

</section>

<!-- ================= LEADERBOARD ================= -->
<div class="container pb-5">
<div class="board">

<div class="sticker st1">üé≠ Campus</div>
<div class="sticker st2">üéâ FEST</div>

<div class="table-responsive" id="leaderboard-container">
<table class="table leaderboard-table align-middle">

<colgroup>
    <col class="col-rank">
    <col class="col-team">
    <col class="col-dept">
    <col class="col-points">
</colgroup>

<thead>
<tr>
    <th>Rank</th>
    <th>Team</th>
    <th>Points</th>
</tr>
</thead>

<tbody>
{% for p in points %}
<tr>
<td>
<span class="rank-badge">
{% if forloop.counter == 1 %}ü•á
{% elif forloop.counter == 2 %}ü•à
{% elif forloop.counter == 3 %}ü•â
{% else %}{{ forloop.counter }}{% endif %}
</span>
</td>

<td>
<a href="{% url 'public_team_detail' p.id %}" class="team-link">
{{ p.team_name }}
</a>
</td>


<td class="points">{{ p.total_points }}</td>
</tr>
{% endfor %}
</tbody>

</table>
</div>

</div>
</div>

<footer>
üé≠ üé® üé∂ ü•Å  
<br>
Ramitham 2025‚Äì26 ¬∑ Department Students‚Äô Union
</footer>

<script>
function refreshBoard(){
    fetch(location.href,{headers:{"X-Requested-With":"XMLHttpRequest"}})
    .then(r=>r.text())
    .then(html=>{
        let doc=new DOMParser().parseFromString(html,"text/html");
        let nc=doc.querySelector("#leaderboard-container");
        let oc=document.querySelector("#leaderboard-container");
        if(!nc)return;
        oc.innerHTML=nc.innerHTML;
        document.querySelectorAll(".points").forEach(p=>{
            p.classList.add("row-updated");
            setTimeout(()=>p.classList.remove("row-updated"),600);
        });
    });
}
setInterval(refreshBoard,10000);
</script>

</body>
</html>
